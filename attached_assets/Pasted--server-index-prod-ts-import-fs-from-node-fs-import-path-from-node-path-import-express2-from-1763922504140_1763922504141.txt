// server/index-prod.ts
import fs from "node:fs";
import path from "node:path";
import express2 from "express";

// server/app.ts
import express from "express";

// server/routes.ts
import { createServer } from "http";

// server/storage.ts
var seedQuestions = [
  {
    id: 1,
    scenario: "\u0635\u062F\u064A\u0642\u0643 \u0627\u0644\u0645\u0641\u0636\u0644 \u0637\u0644\u0628 \u0645\u0646\u0643 \u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631 \u0627\u0644\u062E\u0627\u0635\u0629 \u0628\u062D\u0633\u0627\u0628\u0643. \u0645\u0627\u0630\u0627 \u062A\u0641\u0639\u0644\u061F",
    choice1: "\u0623\u0639\u0637\u064A\u0647 \u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631 \u0644\u0623\u0646\u0647 \u0635\u062F\u064A\u0642\u064A",
    choice2: "\u0623\u0642\u0648\u0644 \u0644\u0647 \u0644\u0627\u060C \u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631 \u0633\u0631\u064A\u0629",
    choice3: "\u0623\u0639\u0637\u064A\u0647 \u0646\u0635\u0641 \u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631 \u0641\u0642\u0637",
    choice4: "\u0623\u0642\u0648\u0644 \u0644\u0647 \u0633\u0623\u0641\u0643\u0631 \u0641\u064A \u0627\u0644\u0623\u0645\u0631 \u0644\u0627\u062D\u0642\u0627\u064B",
    correctAnswer: 2,
    tip: "\u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631 \u0645\u062B\u0644 \u0645\u0641\u062A\u0627\u062D \u0628\u064A\u062A\u0643 - \u0644\u0627 \u062A\u0639\u0637\u064A\u0647\u0627 \u0644\u0623\u062D\u062F \u0623\u0628\u062F\u0627\u064B\u060C \u062D\u062A\u0649 \u0644\u0648 \u0643\u0627\u0646 \u0623\u0642\u0631\u0628 \u0635\u062F\u064A\u0642 \u0644\u0643! \u0627\u062D\u0641\u0638\u0647\u0627 \u0633\u0631\u064A\u0629 \u062F\u0627\u0626\u0645\u0627\u064B.",
    category: "passwords"
  },
  {
    id: 2,
    scenario: "\u0634\u062E\u0635 \u063A\u0631\u064A\u0628 \u0639\u0644\u0649 \u0627\u0644\u0625\u0646\u062A\u0631\u0646\u062A \u0633\u0623\u0644\u0643 \u0639\u0646 \u0639\u0646\u0648\u0627\u0646 \u0645\u0646\u0632\u0644\u0643. \u0645\u0627\u0630\u0627 \u062A\u0641\u0639\u0644\u061F",
    choice1: "\u0623\u062E\u0628\u0631\u0647 \u0628\u0639\u0646\u0648\u0627\u0646 \u0645\u0646\u0632\u0644\u064A",
    choice2: "\u0623\u0639\u0637\u064A\u0647 \u0627\u0633\u0645 \u0627\u0644\u0645\u062F\u064A\u0646\u0629 \u0641\u0642\u0637",
    choice3: "\u0644\u0627 \u0623\u062E\u0628\u0631\u0647 \u0628\u0623\u064A \u0634\u064A\u0621 \u0648\u0623\u062E\u0628\u0631 \u0648\u0627\u0644\u062F\u064A\u0651",
    choice4: "\u0623\u0639\u0637\u064A\u0647 \u0639\u0646\u0648\u0627\u0646 \u0645\u0632\u064A\u0641",
    correctAnswer: 3,
    tip: "\u0639\u0646\u0648\u0627\u0646 \u0628\u064A\u062A\u0643 \u0645\u0639\u0644\u0648\u0645\u0629 \u0633\u0631\u064A\u0629 \u062C\u062F\u0627\u064B. \u0644\u0627 \u062A\u0639\u0637\u064A\u0647\u0627 \u0623\u0628\u062F\u0627\u064B \u0644\u0623\u064A \u0634\u062E\u0635 \u063A\u0631\u064A\u0628 \u0639\u0644\u0649 \u0627\u0644\u0625\u0646\u062A\u0631\u0646\u062A \u0648\u0623\u062E\u0628\u0631 \u0648\u0627\u0644\u062F\u064A\u0643 \u0641\u0648\u0631\u0627\u064B!",
    category: "strangers"
  },
  {
    id: 3,
    scenario: "\u0627\u0644\u062A\u0642\u0637\u062A \u0635\u0648\u0631\u0629 \u062C\u0645\u064A\u0644\u0629 \u0648\u062A\u0631\u064A\u062F \u0646\u0634\u0631\u0647\u0627 \u0639\u0644\u0649 \u0627\u0644\u0625\u0646\u062A\u0631\u0646\u062A. \u0645\u0627\u0630\u0627 \u062A\u0641\u0639\u0644\u061F",
    choice1: "\u0623\u0646\u0634\u0631\u0647\u0627 \u0641\u0648\u0631\u0627\u064B",
    choice2: "\u0623\u0637\u0644\u0628 \u0627\u0644\u0625\u0630\u0646 \u0645\u0646 \u0648\u0627\u0644\u062F\u064A\u0651 \u0623\u0648\u0644\u0627\u064B",
    choice3: "\u0623\u0646\u0634\u0631\u0647\u0627 \u0644\u0643\u0646 \u0623\u062D\u0630\u0641 \u0648\u062C\u0647\u064A \u0645\u0646\u0647\u0627",
    choice4: "\u0623\u0631\u0633\u0644\u0647\u0627 \u0644\u0623\u0635\u062F\u0642\u0627\u0626\u064A \u0641\u0642\u0637",
    correctAnswer: 2,
    tip: "\u062F\u0627\u0626\u0645\u0627\u064B \u0627\u0633\u0623\u0644 \u0648\u0627\u0644\u062F\u064A\u0643 \u0642\u0628\u0644 \u0646\u0634\u0631 \u0623\u064A \u0635\u0648\u0631\u0629. \u0647\u0645 \u064A\u0633\u0627\u0639\u062F\u0648\u0646\u0643 \u062A\u0628\u0642\u0649 \u0622\u0645\u0646\u0627\u064B \u0639\u0644\u0649 \u0627\u0644\u0625\u0646\u062A\u0631\u0646\u062A!",
    category: "sharing"
  },
  {
    id: 4,
    scenario: "\u0637\u0644\u0628 \u0635\u062F\u0627\u0642\u0629 \u0645\u0646 \u0634\u062E\u0635 \u0644\u0627 \u062A\u0639\u0631\u0641\u0647 \u0641\u064A \u0627\u0644\u062D\u064A\u0627\u0629 \u0627\u0644\u062D\u0642\u064A\u0642\u064A\u0629. \u0645\u0627\u0630\u0627 \u062A\u0641\u0639\u0644\u061F",
    choice1: "\u0623\u0642\u0628\u0644 \u0627\u0644\u0637\u0644\u0628 \u0644\u0623\u0646\u0647 \u064A\u0628\u062F\u0648 \u0644\u0637\u064A\u0641\u0627\u064B",
    choice2: "\u0623\u0631\u0641\u0636 \u0627\u0644\u0637\u0644\u0628",
    choice3: "\u0623\u0633\u0623\u0644\u0647 \u0623\u0633\u0626\u0644\u0629 \u0623\u0648\u0644\u0627\u064B",
    choice4: "\u0623\u0642\u0628\u0644\u0647 \u0644\u0643\u0646 \u0644\u0627 \u0623\u062A\u062D\u062F\u062B \u0645\u0639\u0647",
    correctAnswer: 2,
    tip: "\u0627\u0644\u0623\u0634\u062E\u0627\u0635 \u0639\u0644\u0649 \u0627\u0644\u0625\u0646\u062A\u0631\u0646\u062A \u0644\u064A\u0633\u0648\u0627 \u062F\u0627\u0626\u0645\u0627\u064B \u0645\u0646 \u064A\u0642\u0648\u0644\u0648\u0646 \u0623\u0646\u0647\u0645 \u0647\u0645. \u0642\u0628\u0648\u0644 \u0635\u062F\u0627\u0642\u0629 \u0627\u0644\u063A\u0631\u0628\u0627\u0621 \u062E\u0637\u0631 \u0643\u0628\u064A\u0631!",
    category: "strangers"
  },
  {
    id: 5,
    scenario: "\u062A\u0631\u064A\u062F \u062D\u0645\u0627\u064A\u0629 \u062D\u0633\u0627\u0628\u0643 \u0639\u0644\u0649 \u0627\u0644\u0633\u0648\u0634\u064A\u0627\u0644 \u0645\u064A\u062F\u064A\u0627. \u0645\u0627\u0630\u0627 \u062A\u0641\u0639\u0644\u061F",
    choice1: "\u0623\u062C\u0639\u0644 \u062D\u0633\u0627\u0628\u064A \u0639\u0627\u0645\u0627\u064B \u0644\u064A\u0631\u0627\u0647 \u0627\u0644\u062C\u0645\u064A\u0639",
    choice2: "\u0623\u062C\u0639\u0644 \u062D\u0633\u0627\u0628\u064A \u062E\u0627\u0635\u0627\u064B \u0628\u0627\u0633\u062A\u062E\u062F\u0627\u0645 \u0625\u0639\u062F\u0627\u062F\u0627\u062A \u0627\u0644\u062E\u0635\u0648\u0635\u064A\u0629",
    choice3: "\u0644\u0627 \u0623\u0641\u0639\u0644 \u0634\u064A\u0626\u0627\u064B",
    choice4: "\u0623\u0642\u0628\u0644 \u0643\u0644 \u0637\u0644\u0628\u0627\u062A \u0627\u0644\u0635\u062F\u0627\u0642\u0629",
    correctAnswer: 2,
    tip: "\u0625\u0639\u062F\u0627\u062F\u0627\u062A \u0627\u0644\u062E\u0635\u0648\u0635\u064A\u0629 \u062A\u062D\u0645\u064A\u0643! \u062E\u0644\u064A \u062D\u0633\u0627\u0628\u0643 \u062E\u0627\u0635 \u0639\u0634\u0627\u0646 \u0627\u0644\u063A\u0631\u0628\u0627\u0621 \u0645\u0627 \u064A\u0634\u0648\u0641\u0648\u0627 \u0635\u0648\u0631\u0643 \u0648\u0645\u0639\u0644\u0648\u0645\u0627\u062A\u0643.",
    category: "privacy"
  },
  {
    id: 6,
    scenario: "\u0645\u0648\u0642\u0639 \u064A\u0639\u062F\u0643 \u0628\u062C\u0627\u0626\u0632\u0629 \u0645\u062C\u0627\u0646\u064A\u0629 \u0648\u064A\u0637\u0644\u0628 \u0628\u0631\u064A\u062F\u0643 \u0627\u0644\u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A. \u0645\u0627\u0630\u0627 \u062A\u0641\u0639\u0644\u061F",
    choice1: "\u0623\u0639\u0637\u064A\u0647 \u0628\u0631\u064A\u062F\u064A \u0627\u0644\u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A \u0628\u0633\u0631\u0639\u0629",
    choice2: "\u0623\u0639\u0637\u064A\u0647 \u0628\u0631\u064A\u062F \u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A \u0645\u0632\u064A\u0641",
    choice3: "\u0644\u0627 \u0623\u0639\u0637\u064A\u0647 \u0623\u064A \u0634\u064A\u0621 \u0648\u0623\u062E\u0628\u0631 \u0648\u0627\u0644\u062F\u064A\u0651",
    choice4: "\u0623\u0639\u0637\u064A\u0647 \u0631\u0642\u0645 \u0647\u0627\u062A\u0641 \u0628\u062F\u0644\u0627\u064B \u0645\u0646 \u0627\u0644\u0628\u0631\u064A\u062F",
    correctAnswer: 3,
    tip: "\u0627\u0644\u0645\u0648\u0627\u0642\u0639 \u0627\u0644\u0644\u064A \u062A\u0639\u062F\u0643 \u0628\u062C\u0648\u0627\u0626\u0632 \u0645\u062C\u0627\u0646\u064A\u0629 \u063A\u0627\u0644\u0628\u0627\u064B \u0643\u0630\u0628 \u0648\u062E\u062F\u0639\u0629. \u0644\u0627 \u062A\u0639\u0637\u064A \u0645\u0639\u0644\u0648\u0645\u0627\u062A\u0643 \u0623\u0628\u062F\u0627\u064B \u0644\u0623\u064A \u0645\u0648\u0642\u0639 \u0645\u0634\u0643\u0648\u0643 \u0641\u064A\u0647!",
    category: "strangers"
  },
  {
    id: 7,
    scenario: "\u062A\u0631\u064A\u062F \u0625\u0646\u0634\u0627\u0621 \u0643\u0644\u0645\u0629 \u0645\u0631\u0648\u0631 \u062C\u062F\u064A\u062F\u0629. \u0623\u064A \u0648\u0627\u062D\u062F\u0629 \u0623\u0641\u0636\u0644\u061F",
    choice1: "123456",
    choice2: "\u0627\u0633\u0645\u0643 \u0648\u062A\u0627\u0631\u064A\u062E \u0645\u064A\u0644\u0627\u062F\u0643",
    choice3: "\u0643\u0644\u0645\u0629 \u0645\u0631\u0648\u0631 \u0641\u064A\u0647\u0627 \u0623\u062D\u0631\u0641 \u0648\u0623\u0631\u0642\u0627\u0645 \u0648\u0631\u0645\u0648\u0632",
    choice4: "\u0646\u0641\u0633 \u0643\u0644\u0645\u0629 \u0645\u0631\u0648\u0631 \u0643\u0644 \u0623\u0635\u062F\u0642\u0627\u0626\u0643",
    correctAnswer: 3,
    tip: "\u0643\u0644\u0645\u0627\u062A \u0627\u0644\u0645\u0631\u0648\u0631 \u0627\u0644\u0642\u0648\u064A\u0629 \u0635\u0639\u0628 \u062C\u062F\u0627\u064B \u0639\u0644\u0649 \u0627\u0644\u0646\u0627\u0633 \u0627\u0644\u0633\u064A\u0626\u0629 \u0623\u0646\u0647\u0627 \u062A\u062E\u0645\u0646\u0647\u0627. \u0627\u0633\u062A\u062E\u062F\u0645 \u062D\u0631\u0648\u0641 \u0648\u0623\u0631\u0642\u0627\u0645 \u0648\u0631\u0645\u0648\u0632 \u062F\u0627\u0626\u0645\u0627\u064B!",
    category: "passwords"
  },
  {
    id: 8,
    scenario: "\u0623\u0631\u0633\u0644 \u0644\u0643 \u0623\u062D\u062F \u0631\u0633\u0627\u0644\u0629 \u0633\u064A\u0626\u0629 \u0648\u0645\u0632\u0639\u062C\u0629 \u0639\u0644\u0649 \u0627\u0644\u0625\u0646\u062A\u0631\u0646\u062A. \u0645\u0627\u0630\u0627 \u062A\u0641\u0639\u0644\u061F",
    choice1: "\u0623\u0631\u062F \u0639\u0644\u064A\u0647 \u0628\u0631\u0633\u0627\u0644\u0629 \u0633\u064A\u0626\u0629",
    choice2: "\u0623\u062A\u062C\u0627\u0647\u0644 \u0627\u0644\u0631\u0633\u0627\u0644\u0629",
    choice3: "\u0623\u062E\u0628\u0631 \u0648\u0627\u0644\u062F\u064A\u0651 \u0623\u0648 \u0645\u0639\u0644\u0645\u064A \u0641\u0648\u0631\u0627\u064B",
    choice4: "\u0623\u062D\u0630\u0641 \u0627\u0644\u0631\u0633\u0627\u0644\u0629 \u0641\u0642\u0637",
    correctAnswer: 3,
    tip: "\u0644\u0648 \u062D\u062F \u0642\u0627\u0644 \u0644\u0643 \u0643\u0644\u0627\u0645 \u0648\u062D\u0634 \u0639\u0644\u0649 \u0627\u0644\u0646\u062A\u060C \u0623\u0647\u0644\u0643 \u0623\u0648 \u0645\u0639\u0644\u0645\u0643 \u064A\u0642\u062F\u0631\u0648\u0627 \u064A\u0633\u0627\u0639\u062F\u0648\u0643 \u0648\u064A\u062D\u0645\u0648\u0643. \u0644\u0627 \u062A\u062E\u0627\u0641 \u062A\u0642\u0648\u0644 \u0644\u0647\u0645!",
    category: "strangers"
  },
  {
    id: 9,
    scenario: "\u0627\u0644\u062A\u0642\u0637\u062A \u0635\u0648\u0631\u0629 \u0641\u064A \u0627\u0644\u0645\u062F\u0631\u0633\u0629 \u0648\u0627\u0633\u0645 \u0645\u062F\u0631\u0633\u062A\u0643 \u0648\u0627\u0636\u062D \u0641\u064A \u0627\u0644\u062E\u0644\u0641\u064A\u0629. \u0645\u0627\u0630\u0627 \u062A\u0641\u0639\u0644\u061F",
    choice1: "\u0623\u0646\u0634\u0631 \u0627\u0644\u0635\u0648\u0631\u0629 \u0643\u0645\u0627 \u0647\u064A",
    choice2: "\u0644\u0627 \u0623\u0646\u0634\u0631 \u0627\u0644\u0635\u0648\u0631\u0629 \u0644\u0623\u0646 \u0641\u064A\u0647\u0627 \u0645\u0639\u0644\u0648\u0645\u0627\u062A \u062E\u0637\u064A\u0631\u0629",
    choice3: "\u0623\u0646\u0634\u0631\u0647\u0627 \u0644\u0643\u0646 \u0623\u0643\u062A\u0628 \u0627\u0633\u0645 \u0645\u062F\u0631\u0633\u0629 \u0623\u062E\u0631\u0649",
    choice4: "\u0623\u0646\u0634\u0631\u0647\u0627 \u0644\u0623\u0635\u062F\u0642\u0627\u0626\u064A \u0627\u0644\u0645\u0642\u0631\u0628\u064A\u0646 \u0641\u0642\u0637",
    correctAnswer: 2,
    tip: "\u0627\u0644\u0635\u0648\u0631 \u0627\u0644\u0644\u064A \u0641\u064A\u0647\u0627 \u0627\u0633\u0645 \u0645\u062F\u0631\u0633\u062A\u0643 \u0623\u0648 \u0623\u0645\u0627\u0643\u0646 \u062A\u0631\u0648\u062D\u0647\u0627 \u062A\u062E\u0644\u064A \u0627\u0644\u063A\u0631\u0628\u0627\u0621 \u064A\u0639\u0631\u0641\u0648\u0627 \u0641\u064A\u0646 \u064A\u0644\u0627\u0642\u0648\u0643. \u062F\u064A \u0645\u0639\u0644\u0648\u0645\u0627\u062A \u062E\u0637\u064A\u0631\u0629 \u062C\u062F\u0627\u064B!",
    category: "sharing"
  },
  {
    id: 10,
    scenario: "\u0623\u0631\u0633\u0644 \u0644\u0643 \u0634\u062E\u0635 \u0644\u0627 \u062A\u0639\u0631\u0641\u0647 \u0631\u0627\u0628\u0637\u0627\u064B \u0648\u0642\u0627\u0644 \u0627\u0636\u063A\u0637 \u0639\u0644\u064A\u0647. \u0645\u0627\u0630\u0627 \u062A\u0641\u0639\u0644\u061F",
    choice1: "\u0623\u0636\u063A\u0637 \u0639\u0644\u0649 \u0627\u0644\u0631\u0627\u0628\u0637 \u0644\u0623\u0631\u0649 \u0645\u0627 \u0641\u064A\u0647",
    choice2: "\u0623\u0633\u0623\u0644 \u0634\u062E\u0635\u0627\u064B \u0643\u0628\u064A\u0631\u0627\u064B \u0642\u0628\u0644 \u0627\u0644\u0636\u063A\u0637 \u0639\u0644\u064A\u0647",
    choice3: "\u0623\u0631\u0633\u0644 \u0627\u0644\u0631\u0627\u0628\u0637 \u0644\u0623\u0635\u062F\u0642\u0627\u0626\u064A",
    choice4: "\u0623\u0636\u063A\u0637 \u0639\u0644\u064A\u0647 \u0644\u0643\u0646 \u0628\u0633\u0631\u0639\u0629",
    correctAnswer: 2,
    tip: "\u0627\u0644\u0631\u0648\u0627\u0628\u0637 \u0645\u0646 \u0646\u0627\u0633 \u0645\u0634 \u0639\u0627\u0631\u0641\u0647\u0645 \u0645\u0645\u0643\u0646 \u062A\u0643\u0648\u0646 \u0641\u064A\u0647\u0627 \u0641\u064A\u0631\u0648\u0633\u0627\u062A \u0623\u0648 \u062D\u0627\u062C\u0627\u062A \u062E\u0637\u064A\u0631\u0629. \u062F\u0627\u064A\u0645\u0627\u064B \u0627\u0633\u0623\u0644 \u0634\u062E\u0635 \u0643\u0628\u064A\u0631 \u0627\u0644\u0623\u0648\u0644!",
    category: "privacy"
  }
];
var MemStorage = class {
  questions;
  constructor() {
    this.questions = /* @__PURE__ */ new Map();
    seedQuestions.forEach((q) => {
      this.questions.set(q.id, q);
    });
  }
  async getAllQuestions() {
    return Array.from(this.questions.values());
  }
  async getQuestion(id) {
    return this.questions.get(id);
  }
};
var storage = new MemStorage();

// server/routes.ts
import { z } from "zod";
var answerSubmissionSchema = z.object({
  questionId: z.number().int().positive(),
  userAnswer: z.number().int().min(1).max(4)
});
async function registerRoutes(app2) {
  app2.get("/api/questions", async (req, res) => {
    try {
      const questions = await storage.getAllQuestions();
      const shuffled = questions.sort(() => Math.random() - 0.5);
      res.json(shuffled);
    } catch (error) {
      console.error("Error fetching questions:", error);
      res.status(500).json({ error: "Failed to fetch questions" });
    }
  });
  app2.post("/api/answer", async (req, res) => {
    try {
      const validationResult = answerSubmissionSchema.safeParse(req.body);
      if (!validationResult.success) {
        return res.status(400).json({
          error: "Invalid request body",
          details: validationResult.error.errors
        });
      }
      const { questionId, userAnswer } = validationResult.data;
      const question = await storage.getQuestion(questionId);
      if (!question) {
        return res.status(404).json({ error: "Question not found" });
      }
      const isCorrect = userAnswer === question.correctAnswer;
      const result = {
        correct: isCorrect,
        correctAnswer: question.correctAnswer,
        tip: question.tip
      };
      res.json(result);
    } catch (error) {
      console.error("Error processing answer:", error);
      res.status(500).json({ error: "Failed to process answer" });
    }
  });
  const httpServer = createServer(app2);
  return httpServer;
}

// server/app.ts
function log(message, source = "express") {
  const formattedTime = (/* @__PURE__ */ new Date()).toLocaleTimeString("en-US", {
    hour: "numeric",
    minute: "2-digit",
    second: "2-digit",
    hour12: true
  });
  console.log(`${formattedTime} [${source}] ${message}`);
}
var app = express();
app.use(express.json({
  verify: (req, _res, buf) => {
    req.rawBody = buf;
  }
}));
app.use(express.urlencoded({ extended: false }));
app.use((req, res, next) => {
  const start = Date.now();
  const path2 = req.path;
  let capturedJsonResponse = void 0;
  const originalResJson = res.json;
  res.json = function(bodyJson, ...args) {
    capturedJsonResponse = bodyJson;
    return originalResJson.apply(res, [bodyJson, ...args]);
  };
  res.on("finish", () => {
    const duration = Date.now() - start;
    if (path2.startsWith("/api")) {
      let logLine = `${req.method} ${path2} ${res.statusCode} in ${duration}ms`;
      if (capturedJsonResponse) {
        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;
      }
      if (logLine.length > 80) {
        logLine = logLine.slice(0, 79) + "\u2026";
      }
      log(logLine);
    }
  });
  next();
});
async function runApp(setup) {
  const server = await registerRoutes(app);
  app.use((err, _req, res, _next) => {
    const status = err.status || err.statusCode || 500;
    const message = err.message || "Internal Server Error";
    res.status(status).json({ message });
    throw err;
  });
  await setup(app, server);
  const port = parseInt(process.env.PORT || "5000", 10);
  server.listen({
    port,
    host: "0.0.0.0",
    reusePort: true
  }, () => {
    log(`serving on port ${port}`);
  });
}

// server/index-prod.ts
async function serveStatic(app2, _server) {
  const distPath = path.resolve(import.meta.dirname, "public");
  if (!fs.existsSync(distPath)) {
    throw new Error(
      `Could not find the build directory: ${distPath}, make sure to build the client first`
    );
  }
  app2.use(express2.static(distPath));
  app2.use("*", (_req, res) => {
    res.sendFile(path.resolve(distPath, "index.html"));
  });
}
(async () => {
  await runApp(serveStatic);
})();
export {
  serveStatic
};